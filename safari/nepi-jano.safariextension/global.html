<!DOCTYPE HTML>
<html>
	<head>
		<script type="text/javascript">
			function doXhr(url, event) {
				var xhr = new XMLHttpRequest();
				xhr.open("GET", url, true);
				xhr.onreadystatechange = function() {
					if (xhr.readyState === 4 && xhr.status === 200) {
						event.target.page.dispatchMessage("article", xhr.responseText);
					}
				}
				xhr.send();
			}

			safari.application.addEventListener("message", function(event) {
				if (event.name === "doXhr") {
					var url = event.message;
					doXhr(url, event);
				}
			}, false);
		</script>
	</head>
	<body></body>
</html>
